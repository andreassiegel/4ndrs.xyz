<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Andreas Siegel"><meta name=description content="some guy passionate about IT and other things"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="JavaScript Testing with Jest in IntelliJ IDEA"><meta name=twitter:description content="JetBrains IntelliJ IDEA is the best IDE I have ever worked with, and I guess don&rsquo;t ever want to use anything else - or the tool I would prefer to use instead is yet to be invented.
Where it all started Most of the time, I used IntelliJ for Java development. Everything just works, right out of the box. Awesome! However, then there is this moment where you use something else, Node."><meta property="og:title" content="JavaScript Testing with Jest in IntelliJ IDEA"><meta property="og:description" content="JetBrains IntelliJ IDEA is the best IDE I have ever worked with, and I guess don&rsquo;t ever want to use anything else - or the tool I would prefer to use instead is yet to be invented.
Where it all started Most of the time, I used IntelliJ for Java development. Everything just works, right out of the box. Awesome! However, then there is this moment where you use something else, Node."><meta property="og:type" content="article"><meta property="og:url" content="https://4ndrs.xyz/posts/nodejs-test-intellij/"><meta property="article:published_time" content="2020-04-17T19:38:04+02:00"><meta property="article:modified_time" content="2020-04-17T19:38:04+02:00"><base href=https://4ndrs.xyz/posts/nodejs-test-intellij/><title>JavaScript Testing with Jest in IntelliJ IDEA · 4ndrs.xyz</title><link rel=canonical href=https://4ndrs.xyz/posts/nodejs-test-intellij/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.11.2/css/all.css integrity=sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://4ndrs.xyz/css/coder.min.365fc6d23b8b25f2390eead64f5fb2e5b371942dc4ba4f105deb7dd6962de016.css integrity="sha256-Nl/G0juLJfI5DurWT1+y5bNxlC3Euk8QXet91pYt4BY=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://4ndrs.xyz/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://4ndrs.xyz/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.69.0"></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://4ndrs.xyz/>4ndrs.xyz</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://4ndrs.xyz/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://4ndrs.xyz/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://4ndrs.xyz/categories/>Categories</a></li><li class=navigation-item><a class=navigation-link href=https://4ndrs.xyz/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>JavaScript Testing with Jest in IntelliJ IDEA</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2020-04-17T19:38:04+02:00>April 17, 2020</time></span>
<span class=reading-time><i class="fas fa-clock"></i>7-minute read</span></div><div class=categories><i class="fas fa-folder"></i><a href=https://4ndrs.xyz/categories/testing/>Testing</a></div><div class=tags><i class="fas fa-tag"></i><a href=https://4ndrs.xyz/tags/intellij/>intellij</a>
<span class=separator>•</span>
<a href=https://4ndrs.xyz/tags/javascript/>javascript</a>
<span class=separator>•</span>
<a href=https://4ndrs.xyz/tags/nodejs/>nodejs</a>
<span class=separator>•</span>
<a href=https://4ndrs.xyz/tags/jest/>jest</a>
<span class=separator>•</span>
<a href=https://4ndrs.xyz/tags/test/>test</a></div></div></header><div><p>JetBrains IntelliJ IDEA is the best IDE I have ever worked with, and I guess don&rsquo;t ever want to use anything else - or the tool I would prefer to use instead is yet to be invented.</p><h2 id=where-it-all-started>Where it all started</h2><p>Most of the time, I used IntelliJ for Java development. Everything just works, right out of the box. Awesome!
However, then there is this moment where you use something else, Node.js for instance.
And, of course, you want to use it with the same ease.</p><p>For run configurations to execute the application, everything is fine. Right-click on the application&rsquo;s main <code>*.js</code> file and it runs. Great!</p><p>What about tests? In Java projects, I do a right-click on the test sources root, and it just works. IntelliJ runs JUnit and I can easily select which tests to run, etc.</p><h2 id=moving-on-to-javascriptnodejs>Moving on to JavaScript/Node.js</h2><p>Okay, let&rsquo;s get away from Java, let&rsquo;s set up a Node.js project, add a <code>__tests__</code> folder, and use <a href=https://jestjs.io/>Jest</a> for delightful JavaScript testing.
That&rsquo;s easy enough:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm init
// ...
// Answer some questions and finish the initialization of the new project
// ...
$ mkdir __tests__
</code></pre></div><h2 id=configure-jest>Configure Jest</h2><p>Now, we just need to configure Jest in the <code>package.json</code> file to run our tests:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;hello-jest&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;version&#34;</span>: <span style=color:#4070a0>&#34;1.0.0&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;description&#34;</span>: <span style=color:#4070a0>&#34;Just a sample on how to run tests with Jest&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;main&#34;</span>: <span style=color:#4070a0>&#34;index.js&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;scripts&#34;</span>: {
    <span style=color:#062873;font-weight:700>&#34;test&#34;</span>: <span style=color:#4070a0>&#34;npx jest&#34;</span>
  },
  <span style=color:#062873;font-weight:700>&#34;author&#34;</span>: <span style=color:#4070a0>&#34;John Doe&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;license&#34;</span>: <span style=color:#4070a0>&#34;ISC&#34;</span>,
  <span style=color:#062873;font-weight:700>&#34;jest&#34;</span>: {
    <span style=color:#062873;font-weight:700>&#34;verbose&#34;</span>: <span style=color:#007020;font-weight:700>true</span>,
    <span style=color:#062873;font-weight:700>&#34;testEnvironment&#34;</span>: <span style=color:#4070a0>&#34;node&#34;</span>,
    <span style=color:#062873;font-weight:700>&#34;testRegex&#34;</span>: <span style=color:#4070a0>&#34;(/__tests__/.*|(\\.|/)(test|spec))\\.jsx?$&#34;</span>
  }
}
</code></pre></div><p>Before we go on, we probably want to ensure you have Jest installed on our machine:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm install -g jest
</code></pre></div><p>This is all we need to set up. Easy enough, right?</p><h2 id=a-first-test>A First Test</h2><p>Let&rsquo;s quickly add some sample test so that we actually have something to run:
Since we configured Jest to run tests that match a certain regular expression, we create a new file in the <code>__tests__</code> folder and name it <code>hello.test.js</code>:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>describe(<span style=color:#4070a0>&#39;Example Test&#39;</span>, () =&gt; {
  it(<span style=color:#4070a0>&#39;ensures 1 + 1 = 2&#39;</span>, () =&gt; {
    <span style=color:#007020;font-weight:700>const</span> a <span style=color:#666>=</span> <span style=color:#40a070>1</span>
    <span style=color:#007020;font-weight:700>const</span> b <span style=color:#666>=</span> <span style=color:#40a070>1</span>
    <span style=color:#007020;font-weight:700>const</span> c <span style=color:#666>=</span> a <span style=color:#666>+</span> b

    expect(c).toEqual(<span style=color:#40a070>2</span>)
  })
})
</code></pre></div><h2 id=run-the-test-from-the-command-line>Run the Test from the Command Line</h2><p>To actually run the test, head back to the command line and run this command:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm <span style=color:#007020>test</span>
</code></pre></div><p>You should get some output like this:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; hello-test@1.0.0 test /Users/andreas/Documents/development/hello-test
&gt; npx jest

 PASS  __tests__/index.test.js
  Example Test
    ✓ ensures 1 + 1 = 2 (3ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.79s, estimated 1s
Ran all test suites.
</code></pre></div><h2 id=set-up-the-project-in-intellij>Set up the Project in IntelliJ</h2><p>I love the command line but, as I already said, I also like my IntelliJ IDE.
During development, I would like to be able to run tests often, selectively, and as easily as possible.</p><p>Therefore, I want to use my favorite tool to work with our little project.
If we did not create the project in IntelliJ already, we have to import the project there.</p><p>Go to <em>File > New > Project from Existing Sources&mldr;</em> and navigate to the directory containing the project we just created.
I select the <code>package.json</code> file (I import Java projects selecting the <code>pom.xml</code> Maven file) and click <em>Open</em>.</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/cannot-import.png alt="Cannot Import"><figcaption><p>Cannot Import anything&mldr;</p></figcaption></figure><p>Well, that is not exactly what we wanted to happen, right?</p><p>Next, don&rsquo;t select any particular file, just navigate to the project folder and click <em>Open</em>.
That should work and you can proceed clicking <em>Next</em> until there is no option to click <em>Next</em> anymore.</p><p><strong>Lesson learned: If you import JavaScript projects in IntelliJ, always select the project folder!</strong></p><h2 id=use-intellij-to-run-the-tests>Use IntelliJ to Run the Tests</h2><p>Now that we were able to import the project successfully, it&rsquo;s time to run the tests again.</p><h3 id=no-working-default>No Working Default</h3><p>Above, I said it&rsquo;s possible to run Java tests from the context menu.
Trying the same for a JavaScript project doesn&rsquo;t seem to be that successful:</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/context-run.png alt="Context Menu Run: No tests"><figcaption><p>Nothing to run here&mldr;</p></figcaption></figure><p>Unfortunately, the cute little Gopher won&rsquo;t be able to help us with this problem.</p><p>Given the wide variety of JavaScript frameworks and libraries, it&rsquo;s not really a surprise that there is no working default run configuration, though.
Marking the <code>__tests__</code> folder as &ldquo;test sources root&rdquo; also doesn&rsquo;t change anything, by the way - except for the icon turning green.</p><h3 id=create-a-run-configuration-for-jest>Create a Run Configuration for Jest</h3><p>So we have to head to the top-right corner to edit the run configurations and add a new Jest run configuration.</p><p>For that, we will have to enter the path to the Jest installation.
This had been displayed after installing Jest:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm install -g jest
npm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated
npm WARN deprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated
npm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142
/usr/local/bin/jest -&gt; /usr/local/lib/node_modules/jest/bin/jest.js
+ jest@25.3.0
added <span style=color:#40a070>484</span> packages from <span style=color:#40a070>287</span> contributors in 24.374s
</code></pre></div><p>The path that we will need is <code>/usr/local/lib/node_modules/jest</code>.
Don&rsquo;t worry if we didn&rsquo;t capture that.
It&rsquo;s just in the default root path for NPM packages,
and we can check the configuration for that pretty easily:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm root -g
/usr/local/lib/node_modules
</code></pre></div><p>With that information, we can configure a new run configuration for <em>Jest</em>.
Click the <code>+</code> Icon and type to search for <em>Jest</em>.</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/jest-runconfig.png alt="Jest Run Configuration"><figcaption><p>Jest Run Configuration</p></figcaption></figure><p>There is not much we have to configure here, just:</p><ul><li>set the path to the Jest package</li><li>make sure the project directory is set as working directory (default)</li><li>select <em>All tests</em> (default)</li></ul><p>Regardless of the fact that we installed Jest globally to be able to use it from the command line,
we should also add it to the <code>devDependencies</code> in <code>package.json</code>:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ npm install --save-dev jest
</code></pre></div><p>Otherwise, we will not be able to use the run icons in the gutter next to the source code to run our tests.
This also means that we could configure the <code>node_modules</code> directory from the project as the Jest package location for the run configuration.</p><p><strong>Lesson learned: Defining a package location in a run configuration alone does not mean that we can use all nice features of our IDE with that.</strong></p><p>That&rsquo;s it! We are all set to run all tests within our project within IntelliJ using the new run configuration.
Simply press <code>Ctrl+R</code> (or <code>Ctr+D</code> for debug mode) to run the tests.</p><h3 id=add-a-few-more-tests>Add a few more Tests</h3><p>Whether we create another test case or test suite within the same file - or even additional test files - doesn&rsquo;t matter.
The <em>All Tests</em> configuration enables us to run all tests in our application in IntelliJ regardless of where they&rsquo;re located - just like from the command line.</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/all-tests.png alt="All tests run..."><figcaption><p>All tests run&mldr;</p></figcaption></figure><h2 id=selectively-run-tests>Selectively run Tests</h2><p>Different from the command line, we&rsquo;re not restricted to running all tests all the time, though.
We also have the debug mode right at hand and can specifically decide what to run or debug right next to the source code:</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/selective-tests.png alt="Select what to run"><figcaption><p>Selective test execution under full control</p></figcaption></figure><p>With that, we have all the magic I was used to in my Java projects available in a Node.js JavaScript project.</p><h2 id=bonus-live-testing>Bonus: Live Testing</h2><p>During development, we usually want to run our tests reasonably often to notice when changes break something as soon as possible.</p><p>Jest got us covered: It provides <code>--watch</code> or <code>--watchAll</code> flags that allow us to rerun the tests whenever something changes in the source code.
We will not be able to use <code>--watch</code> if the project is not a Git project but <code>--watchAll</code> will do the trick in that case.</p><figure><img src=https://4ndrs.xyz/images/posts/js-test-intellij/automatic-rerun.png alt="Automatically rerun tests"><figcaption><p>Oops, something broke - automatically rerun tests on code change</p></figcaption></figure><p>Isn&rsquo;t that awesome?! It&rsquo;s also something I did not know from my work in Java projects.
On the other hand, that&rsquo;s just because I didn&rsquo;t know about the <a href=https://infinitest.github.io/>Infinitest</a> plugin so far.</p><h2 id=summary>Summary</h2><p>In this article, we&rsquo;ve seen how to</p><ul><li>initialize a new Node.js project</li><li>install and configure Jest to run tests</li><li>import the project in IntelliJ IDEA</li><li>add a run configuration for Jest tests</li><li>selectively run or debug tests in IntelliJ</li><li>watch source code for changes and rerun the tests</li></ul><p><strong>Happy testing!</strong></p></div><footer><h2>See Also</h2><ul><li><a href=https://4ndrs.xyz/posts/slack-status-zoom-meeting/>Using Hammerspoon to automatically set Slack Status when in Zoom Meeting</a></li><li><a href=https://4ndrs.xyz/posts/macos-vpn-command-line-anyconnect/>Use Cisco AnyConnect to Connect to a VPN from the Command Line on Mac OS</a></li><li><a href=https://4ndrs.xyz/posts/macos-vpn-command-line/>Connect to a VPN from the Command Line on Mac OS</a></li></ul><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"4ndrs-xyz"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></section></div><footer class=footer><section class=container>©
2017 -
2020
Andreas Siegel</section></footer></main><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-431647-14','auto');ga('send','pageview');}</script></body></html>